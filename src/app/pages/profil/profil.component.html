<app-header></app-header>
<app-navbar></app-navbar>
<div class="flex flex-col md:flex-row">
    <div class="md:w-1/3 p-4">
      <mat-card class="mb-4 flex flex-col items-center">
        <mat-card-header class="flex flex-col items-center mb-10">
          <div *ngIf="currentUser.imageUrl" class="flex justify-center">
            <img mat-card-image [src]="'data:image/jpeg;base64,' + currentUser.imageUrl" alt="User image" class="w-64 h-64 object-cover mx-auto hover:opacity-75 hover:cursor-pointer" (click)="imageUpload.click()">
          </div>
          <div *ngIf="!currentUser.imageUrl" class="flex justify-center">
            <img mat-card-image [src]="defaultImage" alt="User image" class="w-64 h-64 object-cover mx-auto hover:opacity-75 hover:cursor-pointer" (click)="imageUpload.click()">
          </div>
          <input type="file" #imageUpload style="display: none;" (change)="onFileSelected($event)"  accept=".jpg, .jpeg, .png"/>
          <div *ngIf="loading" class="flex justify-center items-center">
            <div class="spinner">
                <div class="bounce1"></div>
                <div class="bounce2"></div>
                <div class="bounce3"></div>
            </div>
          </div>
        </mat-card-header>
        <p *ngIf="error" class="text-red-500 text-center">{{ error }}</p>
        <mat-card-content class="flex flex-col items-center justify-center text-center">
          <h2 mat-card-title class="text-center">{{ currentUser.firstName }} {{ currentUser.lastName }}</h2>
          <p mat-card-subtitle class="text-center">Inscrit(e) {{creationDate}}</p>
          <button mat-button color="primary" (click)="openEditDialog()" class="text-center cursor-pointer flex items-center justify-center">
            <mat-icon class="mr-2 text-center">
              edit
            </mat-icon>
            Éditer le profil
          </button>
        </mat-card-content>
      </mat-card>
      <mat-card class="mb-4 flex flex-col items-center">
        <mat-card-content class="flex flex-col items-center justify-center">
          <h2 mat-card-title>Statistiques</h2>
          <p><mat-icon>comment</mat-icon> 43 commentaires</p>
          <p><mat-icon>emoji_emotions</mat-icon> 5 réactions</p>
          <p><mat-icon>reply</mat-icon> 10 réponses</p>
        </mat-card-content>
      </mat-card>
    </div>
    <div class="md:w-2/3 p-4">
        <div class="flex justify-between items-center">
            <h2 class="text-2xl">Mes activités</h2>
            <button mat-raised-button color="primary" [routerLink]="['/community']" class="text-green-500 font-bold hover:text-green-600 ">Aller dans l'onglet communauté</button>
        </div>
        <cdk-virtual-scroll-viewport itemSize="100" class="viewport">
            <mat-card *cdkVirtualFor="let activitie of activities" class="mb-6 example-item cursor-pointer" [routerLink]="['/community']">
                <table>
                <tr>
                  <td class="w-1/2 pl-9">
                    <img mat-card-image [src]="activitie.imageUrl" alt="Activitie image" class="w-64 h-64 object-cover">
                  </td>
                  <td class="w-1/2 pl-4">
                    <h2 mat-card-title>{{ activitie.name }}</h2>
                    <p>{{ activitie.description }}</p>
                    <p>{{ activitie.createdAt | date }}</p>
                    <mat-card-actions>
                      <button mat-button [routerLink]="">Voir plus</button>
                    </mat-card-actions>
                  </td>
                </tr>
                </table>
                <hr class="mt-4" *ngIf="activitie !== activities[activities.length - 1]">
            </mat-card>
        </cdk-virtual-scroll-viewport>
      </div>
  </div>
<app-footer></app-footer>
